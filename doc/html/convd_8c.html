<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libconvd: src/convd/convd.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libconvd
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('convd_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">convd.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="convd__i_8h_source.html">convd_i.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a54b136bdc2728e5106d00c0ccff09461"><td class="memItemLeft" align="right" valign="top"><a id="a54b136bdc2728e5106d00c0ccff09461"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>convd_cleanup_cb</b> (<a class="el" href="struct__conv__descriptor__t.html">conv_descriptor_t</a> *cvd)</td></tr>
<tr class="separator:a54b136bdc2728e5106d00c0ccff09461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2883a739b9e730488534184ad38ca95b"><td class="memItemLeft" align="right" valign="top"><a id="a2883a739b9e730488534184ad38ca95b"></a>
<a class="el" href="structconv__buf__t.html">conv_buf_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>convbufMake</b> (<a class="el" href="structconv__buf__t.html">conv_buf_t</a> *cvbuf, char *arraybytes, size_t numbytes)</td></tr>
<tr class="separator:a2883a739b9e730488534184ad38ca95b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88ecc4ce404a51e7f714d684386fef56"><td class="memItemLeft" align="right" valign="top"><a id="a88ecc4ce404a51e7f714d684386fef56"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>ucs_file_read_open</b> (<a class="el" href="struct__conv__descriptor__t.html">convd_t</a> cvd, const char *pathfile, ub4 linesizemax, <a class="el" href="struct__conv__position__t.html">convpos_t</a> *_cpos)</td></tr>
<tr class="separator:a88ecc4ce404a51e7f714d684386fef56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88f98a394fc6472ec23d3a09a5f87075"><td class="memItemLeft" align="right" valign="top"><a id="a88f98a394fc6472ec23d3a09a5f87075"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>ucs_file_read_next</b> (<a class="el" href="struct__conv__position__t.html">convpos_t</a> cpos)</td></tr>
<tr class="separator:a88f98a394fc6472ec23d3a09a5f87075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19334cb53e0bd3f5ad49f85254b22e8f"><td class="memItemLeft" align="right" valign="top"><a id="a19334cb53e0bd3f5ad49f85254b22e8f"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>ucs_file_read_close</b> (<a class="el" href="struct__conv__position__t.html">convpos_t</a> cpos)</td></tr>
<tr class="separator:a19334cb53e0bd3f5ad49f85254b22e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9158a3673ac62a422647f650509a5467"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="convd_8c.html#a9158a3673ac62a422647f650509a5467">convd_create</a> (const char *fromcode, const char *tocode, <a class="el" href="convd__api_8h.html#ac49e30a1de789417659c24956265af67">CONVD_SUFFIX_MODE</a> suffix, <a class="el" href="struct__conv__descriptor__t.html">convd_t</a> *outcvd)</td></tr>
<tr class="separator:a9158a3673ac62a422647f650509a5467"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57a5f12188f497b190124a97fb2fbca3"><td class="memItemLeft" align="right" valign="top"><a id="a57a5f12188f497b190124a97fb2fbca3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>convd_release</b> (<a class="el" href="struct__conv__descriptor__t.html">convd_t</a> *pcvd)</td></tr>
<tr class="separator:a57a5f12188f497b190124a97fb2fbca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33ad560ea15077a16bbc500115f514cb"><td class="memItemLeft" align="right" valign="top"><a id="a33ad560ea15077a16bbc500115f514cb"></a>
<a class="el" href="struct__conv__descriptor__t.html">convd_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>convd_retain</b> (<a class="el" href="struct__conv__descriptor__t.html">convd_t</a> *cvd)</td></tr>
<tr class="separator:a33ad560ea15077a16bbc500115f514cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98eddd2c199fb5ce2f82b73b8c0c59d3"><td class="memItemLeft" align="right" valign="top"><a id="a98eddd2c199fb5ce2f82b73b8c0c59d3"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>convd_fromcode</b> (const <a class="el" href="struct__conv__descriptor__t.html">convd_t</a> cvd)</td></tr>
<tr class="separator:a98eddd2c199fb5ce2f82b73b8c0c59d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af107d431fb789ac7f8d08941dbba9601"><td class="memItemLeft" align="right" valign="top"><a id="af107d431fb789ac7f8d08941dbba9601"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>convd_tocode</b> (const <a class="el" href="struct__conv__descriptor__t.html">convd_t</a> cvd)</td></tr>
<tr class="separator:af107d431fb789ac7f8d08941dbba9601"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd94a0b702566fd5068112ec772e29c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="convd_8c.html#abd94a0b702566fd5068112ec772e29c3">convd_config</a> (const <a class="el" href="struct__conv__descriptor__t.html">convd_t</a> cvd, int request, void *argument)</td></tr>
<tr class="separator:abd94a0b702566fd5068112ec772e29c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a203ae9b8c302b51304cb178978a681f6"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="convd_8c.html#a203ae9b8c302b51304cb178978a681f6">convd_conv_text</a> (<a class="el" href="struct__conv__descriptor__t.html">convd_t</a> cvd, <a class="el" href="structconv__buf__t.html">conv_buf_t</a> *input, <a class="el" href="structconv__buf__t.html">conv_buf_t</a> *output)</td></tr>
<tr class="separator:a203ae9b8c302b51304cb178978a681f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac27acd0c53f89780915688b18db2df4d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="convd_8c.html#ac27acd0c53f89780915688b18db2df4d">convd_conv_file</a> (<a class="el" href="struct__conv__descriptor__t.html">convd_t</a> cvd, const char *textfilein, size_t inoffset, const char *textfileout, const char *outhead, size_t outheadlen, ub4 linesizemax, ub8 *outfilesize, int addbom)</td></tr>
<tr class="separator:ac27acd0c53f89780915688b18db2df4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0a15a64446cb2e3a0f55f3bdd35ccba"><td class="memItemLeft" align="right" valign="top"><a id="ac0a15a64446cb2e3a0f55f3bdd35ccba"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>convd_conv_xmltext</b> (<a class="el" href="struct__conv__descriptor__t.html">convd_t</a> cvd, <a class="el" href="structconv__buf__t.html">conv_buf_t</a> *input, <a class="el" href="structconv__buf__t.html">conv_buf_t</a> *output)</td></tr>
<tr class="separator:ac0a15a64446cb2e3a0f55f3bdd35ccba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecb24970edcd121f4deba9ee5ffe91d5"><td class="memItemLeft" align="right" valign="top"><a id="aecb24970edcd121f4deba9ee5ffe91d5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>convd_conv_xmlfile</b> (<a class="el" href="struct__conv__descriptor__t.html">convd_t</a> cvd, const char *xmlfilein, const char *xmlfileout, ub4 linesizemax, ub8 *outfilesize, int addbom)</td></tr>
<tr class="separator:aecb24970edcd121f4deba9ee5ffe91d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>libconvd implementation.</p>
<dl class="section author"><dt>Author</dt><dd>: </dd></dl>
<dl class="section version"><dt>Version</dt><dd>: @create: $create$ @update: </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="abd94a0b702566fd5068112ec772e29c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd94a0b702566fd5068112ec772e29c3">&#9670;&nbsp;</a></span>convd_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int convd_config </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct__conv__descriptor__t.html">convd_t</a>&#160;</td>
          <td class="paramname"><em>cvd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>argument</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Name convd_config - control and query code conversion behavior.</p>
<p>Synopsis #include &lt;iconv.h&gt; #include &lt;<a class="el" href="convd__api_8h.html" title="libconvd public api.">convd_api.h</a>&gt;</p>
<p>int <a class="el" href="convd__api_8h.html#ac1f60cd5d2aeb3a48c3964ad485d8575">convd_config(const convd_t cvd, int request, void *arg)</a>;</p>
<p>Description The convd_config function is a direct wrapper of iconvctl() (see: iconv.h) and can be used to control code conversion behavior by setting or getting the current code conversion behavior settings from the current code conversion pointed to by the conversion descriptor that was returned from a successful convd_create call.</p>
<p>The following are the supported values for the request argument: (See also: <a href="https://docs.oracle.com/cd/E36784_01/html/E36874/iconvctl-3c.html">https://docs.oracle.com/cd/E36784_01/html/E36874/iconvctl-3c.html</a>)</p>
<p>ICONV_GET_CONVERSION_BEHAVIOR ICONV_SET_CONVERSION_BEHAVIOR ICONV_GET_DISCARD_ILSEQ ICONV_SET_DISCARD_ILSEQ ICONV_GET_TRANSLITERATE ICONV_SET_TRANSLITERATE ICONV_TRIVIALP</p>
<p>Return Value Upon successful completion, <a class="el" href="convd__api_8h.html#ac1f60cd5d2aeb3a48c3964ad485d8575">convd_config()</a> returns 0 and, optionally, with a value pointed to by the arg argument. Otherwise, <a class="el" href="convd__api_8h.html#ac1f60cd5d2aeb3a48c3964ad485d8575">convd_config()</a> returns -1 and sets errno to indicate the error.</p>
<p>Notes convd_config is MT-safety. </p>

</div>
</div>
<a id="ac27acd0c53f89780915688b18db2df4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac27acd0c53f89780915688b18db2df4d">&#9670;&nbsp;</a></span>convd_conv_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int convd_conv_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__conv__descriptor__t.html">convd_t</a>&#160;</td>
          <td class="paramname"><em>cvd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>textfilein</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inoffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>textfileout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>outhead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>outheadlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ub4&#160;</td>
          <td class="paramname"><em>linesizemax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ub8 *&#160;</td>
          <td class="paramname"><em>outfilesize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>addbom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a href="https://worthsen.blog.csdn.net/article/details/86585271">https://worthsen.blog.csdn.net/article/details/86585271</a> </p>

</div>
</div>
<a id="a203ae9b8c302b51304cb178978a681f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a203ae9b8c302b51304cb178978a681f6">&#9670;&nbsp;</a></span>convd_conv_text()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t convd_conv_text </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__conv__descriptor__t.html">convd_t</a>&#160;</td>
          <td class="paramname"><em>cvd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structconv__buf__t.html">conv_buf_t</a> *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structconv__buf__t.html">conv_buf_t</a> *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Name convd_conv_text - character set conversion.</p>
<p>Return Value On success, it returns length of bytes (not less than 0) successfully converted; On error, it returns CONVD_RET_ECONV(-1) and caller can use strerror(errno) to get more error details.</p>
<p>Errors</p>
<p>CONVD_RET_EICONV - Faile to call iconv_open. uses strerror(errno) to get more error details.</p>
<p>Notes input and output should be changed after calling. </p>

</div>
</div>
<a id="a9158a3673ac62a422647f650509a5467"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9158a3673ac62a422647f650509a5467">&#9670;&nbsp;</a></span>convd_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int convd_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fromcode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tocode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="convd__api_8h.html#ac49e30a1de789417659c24956265af67">CONVD_SUFFIX_MODE</a>&#160;</td>
          <td class="paramname"><em>suffix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__conv__descriptor__t.html">convd_t</a> *&#160;</td>
          <td class="paramname"><em>outcvd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new convd_t object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromcode</td><td>Convert characters from encoding </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tocode</td><td>Convert characters to encoding </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">suffix</td><td>Options controlling conversion problems <br  />
 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">outcvd</td><td>The conversion descriptor relates the two encoded character sets. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, it returns CONVD_NOERROR(=0) and the out parameter of outcvd is set by a convd_t object; On error, it returns an error code like CONVD_ERR_?, and out parameter of outcvd is undefined.</dd></dl>
<p>@retal CONVD_NOERROR success @retal CONVD_ERR_FROMCODE invalid value for fromcode @retal CONVD_ERR_TOCODE invalid value for tocode @retal CONVD_ERR_SUFFIX invalid value for suffix @retal CONVD_ERR_ICONV_OPEN an error occurred while calling iconv_open().</p>
<dl class="section note"><dt>Note</dt><dd>convd_t object can be safely accessed from multiple threads (MT-safe). </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_83dee2e705ff9584bacdbc2b84d0f805.html">convd</a></li><li class="navelem"><a class="el" href="convd_8c.html">convd.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
